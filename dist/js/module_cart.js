"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Cart=void 0;var _createClass=function(){function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}}(),_foo=require("./foo.js");function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Cart=function(){function e(){_classCallCheck(this,e),this.ajax=(new _foo.Way).ajax,this.$=(new _foo.Way).$,this.getRequest=(new _foo.Way).getRequest,this.jstcookie={addcookie:(new _foo.Way).addcookie,getcookie:(new _foo.Way).getcookie,delcookie:(new _foo.Way).delcookie}}return _createClass(e,[{key:"cart_init",value:function(){var t=this,e=decodeURIComponent(document.cookie).split("; "),n=[];for(var a in e)n[a]=e[a].split(",")[0].split("=");t.ajax({url:"../php/getData.php",datatype:"json"}).then(function(e){t.cart_render(e,n),t.cart_events()})}},{key:"cart_render",value:function(e,t){var n=this.$(".item-list"),a=!0,i=!1,o=void 0;try{for(var r,c=t[Symbol.iterator]();!(a=(r=c.next()).done);a=!0){var s=r.value;for(var d in console.log(s),e)e[d].pid==s[0]&&(n.innerHTML+='<div class="goods-item goods-item-sele" sid="'+e[d].pid+'"style="display: block;">\n              <div class="goods-info">\n                <div class="cell b-checkbox">\n                  <div class="cart-checkbox">\n                    <input class=\'odd-input\' type="checkbox" name="" id="" value="" />\n                    <span class="line-circle"></span>\n                  </div>\n                </div>\n                <div class="cell b-goods">\n                  <div class="goods-name">\n                    <div class="goods-pic">\n                      <a href=""><img id="sMap" src="'+e[d].url+'" alt="" /></a>\n                    </div>\n                    <div class="goods-msg">\n                      <div class="goods-d-info">\n                        <a href="">'+e[d].title+'</a>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n                <div class="cell b-props">\n                  <div class="prop-text"></div>\n                </div>\n                <div class="cell b-price">\n                  <strong class="unit_price">'+e[d].price+'</strong>\n                </div>\n                <div class="cell b-quantity">\n                  <div class="quantity-form">\n                    <a class="quantity-down" href="javascript:void(0)">-</a>\n                    <input type="text" value="'+s[1]+'" />\n                    <a class="quantity-add" href="javascript:void(0)">+</a>\n                  </div>\n                  <div class="quantity-text">有货</div>\n                </div>\n                <div class="cell b-sum">\n                  <strong class="t-count">'+e[d].price*s[1]+'</strong>\n                </div>\n                <div class="cell b-action">\n                  <a class = "del-btn" href="javascript:void(0)">删除</a>\n                </div>\n              </div>\n            </div>')}}catch(e){i=!0,o=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw o}}}},{key:"cart_events",value:function(){var c=this,i=c.$(".odd-input","true"),o=c.$(".allsel","true"),s=c.$(".quantity-add","true"),d=c.$(".quantity-down","true"),e=(c.$(".del-btn","true"),c.$(".item-list")),t=c.$(".cart-tbody");function n(n,a){o[n].addEventListener("change",function(){if(o[a].checked=!0===o[n].checked,this.checked)for(var e=0;e<i.length;e++)i[e].checked=!0;else for(var t=0;t<i.length;t++)i[t].checked=!1;l()})}function l(){for(var e=c.$(".totalprice"),t=c.$(".t-count","true"),n=0,a=c.$(".odd-input","true"),i=0;i<a.length;i++)!0===a[i].checked&&(n+=parseFloat(t[i].innerHTML));e.innerHTML="￥"+n}function a(e){var t=this.parentNode.childNodes[3],n=this.parentNode.parentNode.parentNode.parentNode.getAttribute("sid"),a=c.$(".goods-item","true"),i=c.$(".t-count","true"),o=c.$(".unit_price","true");"add"==e&&(t.value=parseInt(t.value)+1),"reduce"==e&&(t.value=parseInt(t.value)-1);for(var r=0;r<a.length;r++)this!=s[r]&&this!=d[r]||(i[r].innerHTML=o[r].innerHTML*t.value);c.jstcookie.addcookie(n,t.value),l()}n(0,1),n(1,0),t.addEventListener("click",function(e){if("INPUT"==e.target.nodeName){var t=0;e.target.setAttribute("checked",!0);for(var n=0;n<i.length;n++)!0===i[n].checked&&t++;!1===e.target.checked&&t--,t===i.length?(o[0].checked=!0,o[1].checked=!0):(o[1].checked=!1,o[0].checked=!1),l()}}),e.addEventListener("click",function(e){if("del-btn"==e.target.className&&1==confirm("您确定删除该物品？")){var t=e.target.parentNode.parentNode.parentNode;t.parentNode.removeChild(t),c.jstcookie.delcookie(t.getAttribute("sid")),l()}"quantity-add"==e.target.className&&a.call(e.target,"add"),"quantity-down"==e.target.className&&a.call(e.target,"reduce")})}}]),e}();exports.Cart=Cart;